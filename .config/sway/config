xwayland enable

include /etc/sway/definitions
include /etc/sway/inputs/*
include /etc/sway/modes/*
include /etc/sway/outputs/*

focus_follows_mouse yes
# hide cursor after 5 seconds of inactivity
seat seat0 hide_cursor 5000
bindgesture swipe:right workspace next
bindgesture swipe:left workspace prev

set $WOBSOCK $XDG_RUNTIME_DIR/wob.sock

# launch applications with fzf
set $menu exec $term --class=launcher -e bash -c 'compgen -c | grep -v fzf | sort -u | fzf --layout=reverse | xargs -r swaymsg -t command exec'
for_window [app_id="^launcher$"] floating enable, border none, opacity 0.8

bindsym XF86AudioRaiseVolume exec pamixer -ui 5 && pamixer --get-volume > $WOBSOCK
bindsym XF86AudioLowerVolume exec pamixer -ud 5 && pamixer --get-volume > $WOBSOCK
bindsym XF86AudioMute exec pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > $WOBSOCK ) || pamixer --get-volume > $WOBSOCK
bindsym XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle
bindsym XF86MonBrightnessUp exec light -S "$(light -G | awk '{ print int(($1 + .72) * 1.4) }')" && light -G | cut -d'.' -f1 > $WOBSOCK
bindsym XF86MonBrightnessDown exec light -S "$(light -G | awk '{ print int($1 / 1.4) }')" && light -G | cut -d'.' -f1 > $WOBSOCK

bar {
  # hide bar by default, show with modifier key
  mode hide
  modifier $mod
  hidden_state hide
  position top
  swaybar_command $statusbar
}

exec_always swayidle -d \
  timeout 10 'if pgrep swaylock; then swaymsg "output * dpms off"; fi' resume 'if pgrep swaylock; then swaymsg "output * dpms on"; fi' \
  timeout 3600 'lock' \
  timeout 3602 'swaymsg "output * dpms off"' resume 'swaymsg "output * dpms on"' \
  before-sleep 'lock' >> /var/log/swayidle.log

exec mkfifo $WOBSOCK && tail -f $WOBSOCK | wob

# vim: set filetype=swayconfig foldmethod=marker foldlevel=0 nowrap:
